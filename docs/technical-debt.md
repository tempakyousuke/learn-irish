# Learn Irish プロジェクトの技術的負債

このドキュメントでは、現在のプロジェクトで特定された技術的負債について記載します。技術的負債とは、将来的に対処すべき問題や改善点で、現状では機能しているものの、長期的には保守性、拡張性、セキュリティなどの観点から問題となる可能性があるものです。

## 1. ハードコードされた認証情報

### 問題点
- `src/modules/firebase.ts` にFirebaseの設定情報（APIキーなど）がハードコードされています。
- 本番環境の認証情報がソースコードにそのまま含まれているのはセキュリティリスクです。

### 推奨される対策
- 環境変数を使用して、認証情報を外部ファイル（.envなど）に分離する
- SvelteKitの環境変数システムを活用する
- 異なる環境（開発・テスト・本番）ごとに適切な設定を分ける

## 2. コードの重複と再利用性

### 問題点
- ルートコンポーネント内にナビゲーション関連のコードが直接埋め込まれている
- 認証状態の管理ロジックが複数のコンポーネントに散在している

### 推奨される対策
- ナビゲーションバーとドロワーを独立したコンポーネントに抽出
- 認証状態の管理ロジックをカスタムフックに集約
- 共通UIパターンをコンポーネントライブラリとして整理

## 3. キャッシュ戦略の欠如

### 問題点
- `getTunes.ts` では曲データをメモリ内にキャッシュしていますが、このキャッシュは永続的ではなく、ページのリロードで失われます。
- キャッシュの有効期限や更新戦略が定義されていない

### 推奨される対策
- ローカルストレージまたはIndexedDBを使用した永続キャッシュの実装
- キャッシュの有効期限や更新戦略の定義
- 可能であればServiceWorkerを使用したオフラインサポートの追加

## 4. エラーハンドリングの不足

### 問題点
- Firebase操作（認証、データ取得など）のエラーハンドリングが不十分
- ユーザーに適切なエラーメッセージが表示されない場合がある

### 推奨される対策
- すべてのFirebase操作に包括的なエラーハンドリングを追加
- ユーザーフレンドリーなエラーメッセージの表示
- エラーログの収集と監視の仕組みの導入

## 5. 型定義の改善点

### 問題点
- `tune.ts` の型定義ではほとんどのプロパティがオプショナル（`?:`）になっており、型安全性が低下しています
- NULL値や未定義値の取り扱いが一貫していない

### 推奨される対策
- 必須フィールドとオプショナルフィールドを明確に分ける
- 共通の型定義を作成して一貫性を確保する
- 型ガードを使用して実行時の型安全性を向上させる

## 6. パフォーマンスの最適化

### 問題点
- メインページで複数のフィルタリングやソートロジックが実行されており、大量のデータがある場合にパフォーマンスが低下する可能性
- 仮想スクロールなどの大量リスト表示の最適化が実装されていない

### 推奨される対策
- メインページのパフォーマンスプロファイリングと最適化
- 大量データ表示時の仮想スクロールの実装
- サーバーサイドでのフィルタリングとページネーションの導入

## 7. テストの欠如

### 問題点
- 単体テスト、結合テスト、E2Eテストがプロジェクトに含まれていない
- テスト可能性を考慮した設計になっていない部分がある

### 推奨される対策
- Vitest/Jestを使用した単体テストの導入
- Playwright/Cypressを使用したE2Eテストの導入
- テスタビリティを向上させるためのコード構造の改善

## 8. READMEの不足

### 問題点
- 現在のREADMEファイルはデフォルトのSvelteプロジェクトREADMEをほぼそのまま使用しており、プロジェクト固有の情報が不足

### 推奨される対策
- プロジェクトの目的、機能、技術スタックを詳細に記述したREADMEの作成
- 開発者向けのセットアップ手順とコントリビューションガイドの追加
- プロジェクト構造に関する詳細な説明の追加

## 9. 国際化（i18n）の改善

### 問題点
- 一部の文字列がハードコードされており、完全な国際化がされていない
- 言語切り替え後の状態管理が最適化されていない

### 推奨される対策
- すべての文字列をi18nシステムに移行
- 言語リソースの整理と一貫性の確保
- 言語切り替え時のUX改善

## 10. 依存関係の管理

### 問題点
- 一部の依存パッケージが古いバージョンである可能性
- 依存関係の更新戦略が明確でない

### 推奨される対策
- 依存パッケージの定期的な監査と更新
- セキュリティ脆弱性スキャンの導入
- npm-check-updatesなどのツールを使用した依存関係の管理

## 優先度とロードマップ

上記の技術的負債を優先度順に整理すると、以下のようになります：

1. **高優先度** - 即時対応すべき項目
   - ハードコードされた認証情報の修正
   - エラーハンドリングの改善

2. **中優先度** - 近いうちに対応すべき項目
   - コードの重複と再利用性の改善
   - キャッシュ戦略の実装
   - 型定義の改善

3. **低優先度** - 長期的に対応すべき項目
   - パフォーマンスの最適化
   - テストの導入
   - READMEの改善
   - 国際化の完全実装
   - 依存関係の管理改善

この優先順位に従って計画的に技術的負債を解消していくことで、プロジェクトの保守性、安定性、拡張性を向上させることができます。